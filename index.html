<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HyperVerge KYC Blockchain Demo</title>
    <script
        src="https://hv-camera-web-sg.s3-ap-southeast-1.amazonaws.com/hyperverge-web-sdk@9.15.2/src/sdk.min.js"></script>
    <style>
        @import "style.css";
    </style>
</head>

<body>
    <h2>HyperVerge KYC Blockchain Demo</h2>
    <div>
        <button type="button" onclick="startOnboarding();">
            Start KYC Onboarding
        </button>
    </div>
    <div id="result">KYC Result will appear here...</div>
    <script>
        // Mock blockchain ledger for demo purposes
        const mockBlockchainLedger = [];

        function addToBlockchain(transactionId, kycResult) {
            const timestamp = new Date().toISOString();
            const block = {
                transactionId,
                kycResult,
                timestamp,
                hash: btoa(transactionId + timestamp) // Simple base64 hash for demo
            };
            mockBlockchainLedger.push(block);
            return block;
        }

        function displayResult(message, block = null) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = message;
            if (block) {
                resultDiv.innerHTML += `<br><strong>Blockchain Record:</strong><br>Transaction ID: ${block.transactionId}<br>Result: ${JSON.stringify(block.kycResult)}<br>Timestamp: ${block.timestamp}<br>Hash: ${block.hash}`;
            }
        }

        // async function getAccessToken() {
        //     const response = await fetch('https://auth.hyperverge.co/login', {
        //         method: 'POST',
        //         headers: {
        //             'Content-Type': 'application/json',
        //         },
        //         body: JSON.stringify({  
        //             appId: 'ct4wfd',
        //             appKey: '424tdohz6d3hu7fj0u9l',
        //             WorkflowID: 'workflow_ekyc',
        //             TransactionID: 'TX_1756365267835',
        //             expiry: 4800,
        //         }),
        //     });
        //     const data = await response.json();
        //     const token = data.result.token;
        //     const formatedToken = token.replace("Bearer ", "");
        //     console.log("formatedToken", formatedToken);
        //     return formatedToken;
        // }



        async function startOnboarding() {
            const accessToken = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6ImN0NHdmZCIsImhhc2giOiJmYTg1ODY1NTg4MjliYzEwMDgzYTY0OTRjM2Q5NGM1MWY1NWM2YjM0ZDJmY2MyZmZjZmU3NDY4Y2EwNzk2MTBiIiwiaWF0IjoxNzU2NDUxNjM4LCJleHAiOjE3NTY1MzgwMzgsImp0aSI6IjcwYWI2NmViLTQ3YjAtNDA1YS1iMGE5LTBkYTA0Y2JhMjMwOSJ9.WKQWxHY1LpS7IJ48m3tu96FymoAslg-Mik7Ne7IWSG47XXPwigIgsuipXWY6xqFrKNzvlqT6cfTYUA7bbl_qhBZlWU1v_5_Pa1o9bHwKCpa9K1ozNiextmnclbJeFMdZkFBVkDQohiTM0ZDhJthfaVM3IYpG3_WHBmNyvhMw1zs";
            const hyperKycConfig = new HyperKycConfig(
                accessToken,
                true
            );
            console.log("hyperKycConfig", hyperKycConfig);
            HyperKYCModule.launch(hyperKycConfig, handler);
        }

        const handler = (HyperKycResult) => {
            if (HyperKycResult.Cancelled) {
                // user cancelled
                console.log(HyperKycResult.Cancelled);
            } else if (HyperKycResult.Failure) {
                // failure
                console.log(HyperKycResult.Failure);
            } else if (HyperKycResult.Success) {
                // success
                console.log(HyperKycResult.Success);
            }
        }
    </script>
</body>

</html>